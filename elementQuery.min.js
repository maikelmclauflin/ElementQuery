!function(e,t){function n(e){var t,n=this,r=c(e);for(t in r)n[t]=r[t];return v(n),n}function r(e){var t=this;return this.reinit(e),t}var s={},o=s.hasOwnProperty,u=function(t,n,r){var i,s;if(n&&t){if(r||(r=e),o.apply(t,["length"])&&(s=1),s)for(i=0;i<t.length;i++)n.apply(r,[t[i],i,t]);if(!s)for(i in t)n.apply(r,[t[i],i,t])}return r},a=function(e,t,n){var r=new RegExp(t);return e.replace(r,n)},c=function(e){return{el:e,watchers:{},formerVals:{},currentValidQueries:{},annexes:[]}},l={height:{fn:function(e,t,n){return parseFloat(n.height)}},width:{fn:function(e,t,n){return parseFloat(n.width)}}},f={px:function(e){return e}},h=function(e,t){var n=e.split(t).length-1;return!!n},p=function(e){var t=e.match(/\-.*\~|\~\=/)[0];return t.slice(1,t.length-1)},m=function(e){var t=e.match(/\=(\"|\')(.*)(\"|\')/);return t[2]},y=function(e,t){var n,r,i=[];for(e=e.trim(),n=e.length-1;n>=0;n--)if(i.unshift(e[n]),r=i.join(""),t.indexOf(r)>=0)return"em"===r&&"r"===e[n-1]?"rem":r;return!1},d=function(e,t){var n=t.toString(),r=a(n.slice(1,n.length-1),"{{{}}}",e);return new RegExp(r,"mgi")},v=function(t){var n;window.console.log(t),n=function(){t.update(),e.requestAnimationFrame(n)}.bind(t),e.requestAnimationFrame(n)},g=/,?([^,\n]*)\[[\s\t]*(min|max)-({{{}}})[\s\t]*[~$\^]?=[\s\t]*(["|'](.*)["|'])[\s\t]*]([^\n\s\{]*)/,w=/\,?([[\s\t]*(min|max)-({{{}}})[\s\t]*[~$\^]?=[\s\t]*(["|'](.+?)["|'])[\s\t]*])/;f[""]=f.px,n.prototype={updateUI:function(e){var t,n,r=this,i=r.currentValidQueries[e],s=r.el;for(t in i)attrName=t+"-"+e,n=i[t],n&&(valuesLen=n.length,valuesLen&&s.setAttribute(attrName,n.join(" ")),valuesLen||s.removeAttribute(attrName))},update:function(){var t,n,r,i,s=this,o=s.watchers,u=s.formerVals,a=s.el,c=e.getComputedStyle(a),f=a.getBoundingClientRect(),h=parseFloat(f.height),p=parseFloat(f.width),m=[a,p,h,c,f],y=[];s.latestStyles=c,s.latestClientRect=f,s.latestHeight=h,s.latestWidth=p;for(t in o)n=l[t],r=u[t],i=n.fn.apply(s,m),i!==r&&(u[t]=i,y.push(t),s.currentValidQueries[t]=s.calculateValues(t,i));for(t=0;t<y.length;t++)s.updateUI(y[t])},calculateValues:function(e,t){var n,r,i,s,o,u,a,c,h,p,m,y,d,v,g=this,w=g.el,Q=g.watchers,x=g.latestStyles,P=g.latestClientRect,S=g.latestHeight,V=g.latestWidth;if(d=Q[e],p=l[e],p.fn&&(m=p.fn,m&&"function"==typeof m)){v={min:[],max:[]},o=[w,V,S,x,P],h=m.apply(g,o),s=[h,m].concat(o);for(i in d){c=d[i],t=parseFloat(i);for(r in c)for(a=c[r],n=0;n<a.length;n++)u=a[n],y=f[u].apply(g,s),y>t&&"min"===r&&v[r].push(t+u),t>y&&"max"===r&&v[r].push(t+u)}return v}},hasWatcher:function(e){var t,n,r,i=this,s=i.watchers;if("object"==typeof e&&!Array.isArray(e)){for(t in e)if(s=s[t])for(n in e[t])if(s=s[n])for(r in e[t][n])if(s[r])return 1;return 0}},parseObject:function(e){var t,n,r,i,s,o=[],u={},a=p(e),c=u[a]={};r=m(e);for(t in f)o.push(t);return s=y(r,o),s||(s=""),i=c[r]={},h(e,"min-")&&(n="min"),h(e,"max-")&&(n="max"),i[n]=s,u},extendWatcher:function(e){var t,n,r,i,s=this,o=s.watchers;for(t in e){o[t]||(o[t]={}),s.formerVals[t]||(s.formerVals[t]=0/0),o=o[t];for(n in e[t]){o[n]||(o[n]={}),o=o[n];for(r in e[t][n])o[r]||(o[r]=[]),o=o[r],i=e[t][n][r],-1===o.indexOf(e[t][n][r])&&o.push(i)}}},add:function(e){var t,n=this;return t=n.parseObject(e),n.extendWatcher(t),n},annex:function(e){return this.annexes.push(e),this},runAnnexes:function(){var e,t=this;for(e=0;e<t.annexes.length;e++)t.annexes[e].apply(t);return t}},r.prototype={reinit:function(e){var t=this;return u(l,function(e,t){e.regex=d(t,g)}),e&&(t.styles=e),t.update(),t},update:function(){var e=this;return e.styles&&u(l,function(t){e.scanSelectors(t.regex,function(t,n){e.addRule(t,n)})}),e},scanSelectors:function(e,t){var n,r,i,s=this;u(s.styles,function(o){"object"==typeof o&&(i=o.rules||o.cssRules,u(i,function(i){n=i.selectorText,n&&(r=n.match(e),r&&u(r,function(e){t.apply(s,[e,n,i])}))}))})},addRule:function(e,n){var r,i,s,o,a,c,f,h=this;return f=n.split(e)[0]+e.replace(),c=[],a=[],u(l,function(t,n){if(o=d(n,w),i=f.match(o),s=e.match(o),i)for(r=0;r<i.length;r++)a.push(i[r]),f=f.split(i[r]).join("");if(s)for(r=0;r<s.length;r++)c.push(s[r])}),els=t.querySelectorAll(f),u(els,function(e){u(c,function(t){e instanceof HTMLElement&&h.attach(e,t)})}),h},attach:function(e,t){var n=this;return sensor=n.getSensor(e),sensor.add(t),n},getSensor:function(e){var t,r,i,s,o,u=this,a=e.toString();return u.watchers||(u.watchers={}),r=u.watchers,r[a]||(r[a]={}),i=r[a],i.els||(i.els=[]),i.sensors||(i.sensors=[]),t=i.els,o=i.sensors,s=t.indexOf(e),-1===s&&(s=t.length,t.push(e)),o[s]||(o[s]=new n(e)),o[s]},applySensorValues:function(){var e,t,n,r=this,s=r.watchers;for(e in s)for(t=s[e].sensors,i=0;i<t.length;i++)n=t[i],n.update();return r},unitProcessor:function(e,t){var n=this;return f[e]=t,n},addProcessor:function(e,t){var n=this;return l[e]={fn:t,regex:d(e,g)},n},physicalDistance:function(t){return function(n){return n/e.devicePixelRatio/t}}},e.onload=function(){elementQuery.reinit(t.styleSheets),elementQuery.applySensorValues()},e.ElementQuery=r,e.elementQuery=new e.ElementQuery,elementQuery.unitProcessor("%",function(e,t,n){{var r=n.parentNode,i=r.getBoundingClientRect(),s=r.getComputedStyle(),o=parseFloat(parentStyles.height),u=parseFloat(parentStyles.width);t.apply(this,[r,u,o,i,s])}return e/parentVal}),elementQuery.unitProcessor("em",function(e,t,n,r,i,s){return e/parseFloat(s.fontSize)}),elementQuery.unitProcessor("rem",function(e,t){var n=parseFloat(e.getComputedStyle(t.documentElement).fontSize);return function(e){return e/n}}(window,document)),elementQuery.unitProcessor("in",elementQuery.physicalDistance(96)),elementQuery.unitProcessor("cm",elementQuery.physicalDistance(37.79527559055118)),elementQuery.unitProcessor("mm",elementQuery.physicalDistance(3.779527559055118)),elementQuery.unitProcessor("pc",elementQuery.physicalDistance(16)),elementQuery.unitProcessor("pt",elementQuery.physicalDistance(1.333333333333333)),elementQuery.unitProcessor("vw",function(e){var t=window.innerWidth;return e/(t/100)}),elementQuery.unitProcessor("vh",function(e){var t=window.innerHeight;return e/(t/100)}),elementQuery.unitProcessor("vmax",function(e){var t=Math.max(window.innerHeight,window.innerWidth);return e/(t/100)}),elementQuery.unitProcessor("vmin",function(e){var t=Math.min(window.innerHeight,window.innerWidth);return e/(t/100)}),elementQuery.addProcessor("area",function(e,t,n){return n*t}),elementQuery.addProcessor("diagonal",function(e,t,n){return Math.pow(n*n+t*t,.5)}),elementQuery.addProcessor("aspect",function(e,t,n){return t/n}),elementQuery.addProcessor("perimeter",function(e,t,n){return 2*n+2*t}),e.elementQuery.reinit(t.styleSheets)}(window,document);