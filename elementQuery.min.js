!function(n,t){function e(n){var t,e=this,r=f(n);for(t in r)e[t]=r[t];return g(e),e}function r(n){var t=this;return this.reinit(n),t}var s={},o=s.hasOwnProperty,a=function(t,e,r){var i,s;if(e&&t){if(r||(r=n),o.apply(t,["length"])&&(s=1),s)for(i=0;i<t.length;i++)e.apply(r,[t[i],i,t]);if(!s)for(i in t)e.apply(r,[t[i],i,t])}return r},u=function(n,t,e){var r=new RegExp(t);return n.replace(r,e)},f=function(n){return{el:n,watchers:{},annexes:[]}},c={height:{fn:function(n,t,e){return parseFloat(e.height)}},width:{fn:function(n,t,e){return parseFloat(e.width)}}},l={px:function(n){return n}},h=function(n,t){var e=n.split(t).length-1;return!!e},p=function(n){var t=n.match(/\-.*\~|\~\=/)[0];return t.slice(1,t.length-1)},m=function(n){var t=n.match(/\=(\"|\')(.*)(\"|\')/);return t[2]},d=function(n,t){var e,r,i=[];for(n=n.trim(),e=n.length-1;e>=0;e--)if(i.unshift(n[e]),r=i.join(""),t.indexOf(r)>=0)return"em"===r&&"r"===n[e-1]?"rem":r;return!1},v=function(n,t){var e=t.toString(),r=u(e.slice(1,e.length-1),"{{{}}}",n);return new RegExp(r,"mgi")},g=function(n){var t;t=function(){var n=this,e=n.el.offsetHeight!==n.lastHeight,r=n.el.offsetWidth!==n.lastWidth;(e||r)&&(n.update(),n.runAnnexes(),n.resetDimensions()),window.requestAnimationFrame(t)}.bind(n),window.requestAnimationFrame(t)},y=/,?([^,\n]*)\[[\s\t]*(min|max)-({{{}}})[\s\t]*[~$\^]?=[\s\t]*(["|'](.*)["|'])[\s\t]*]([^\n\s\{]*)/,x=/\,?([[\s\t]*(min|max)-({{{}}})[\s\t]*[~$\^]?=[\s\t]*(["|'](.+?)["|'])[\s\t]*])/;l[""]=l.px,e.prototype={update:function(){var t,e,r,i,s,o,a,u,f,h,p,m,d,v,g,y,x,w=this,S=w.el,A=w.watchers,b={},j=n.getComputedStyle(S),F=w.el.getBoundingClientRect(),R=parseFloat(F.height),W=parseFloat(F.width);w.dimensions=F;for(e in A)if(v=c[e],b["min-"+e]=[],b["max-"+e]=[],v&&(x=A[e],g=v.fn,g&&"function"==typeof g)){o=[S,W,R,j,F],d=g.apply(w,o),s=[d,g].concat(o);for(i in x){f=x[i],val=parseFloat(i);for(r in f)for(u=f[r],h=r+"-"+e,t=0;t<u.length;t++)a=u[t],y=l[a].apply(w,s),val<y&&"min"===r&&b[h].push(val+a),val>y&&"max"===r&&b[h].push(val+a)}}for(e in b)p=b[e],m=p.length,m&&S.setAttribute(e,b[e].join(" ")),m||S.removeAttribute(e)},resetDimensions:function(){var n=this;n.lastWidth=n.el.offsetWidth,n.lastHeight=n.el.offsetHeight},hasWatcher:function(n){var t,e,r,i=this,s=i.watchers;if("object"==typeof n&&!Array.isArray(n)){for(t in n)if(s=s[t])for(e in n[t])if(s=s[e])for(r in n[t][e])if(s[r])return 1;return 0}},parseObject:function(n){var t,e,r,i,s,o,a=[],u={};r=u[p(n)]={},i=m(n);for(t in l)a.push(t);return o=d(i,a),o||(o=""),s=r[i]={},h(n,"min-")&&(e="min"),h(n,"max-")&&(e="max"),s[e]=o,u},extendWatcher:function(n){var t,e,r,i,s=this,o=s.watchers;for(t in n){o[t]||(o[t]={}),o=o[t];for(e in n[t]){o[e]||(o[e]={}),o=o[e];for(r in n[t][e])o[r]||(o[r]=[]),o=o[r],i=n[t][e][r],-1===o.indexOf(n[t][e][r])&&o.push(i)}}},add:function(n){var t,e=this;return t=e.parseObject(n),e.extendWatcher(t),e},annex:function(n){return this.annexes.push(n),this},runAnnexes:function(){var n,t=this;for(n=0;n<t.annexes.length;n++)t.annexes[n].apply(t);return t}},r.prototype={reinit:function(n){var t=this;return a(c,function(n,t){n.regex=v(t,y)}),n&&(t.styles=n),t.update(),t},update:function(){var n=this;return n.styles&&a(c,function(t){n.scanSelectors(t.regex,function(t,e){n.addRule(t,e)})}),n},scanSelectors:function(n,t){var e,r,i,s=this;a(s.styles,function(o){"object"==typeof o&&(i=o.rules||o.cssRules,a(i,function(i){e=i.selectorText,e&&(r=e.match(n),r&&a(r,function(n){t.apply(s,[n,e,i])}))}))})},addRule:function(n,e){var r,i,s,o,u,f,l,h=this;return l=e.split(n)[0]+n.replace(),f=[],u=[],a(c,function(t,e){if(o=v(e,x),i=l.match(o),s=n.match(o),i)for(r=0;r<i.length;r++)u.push(i[r]),l=l.split(i[r]).join("");if(s)for(r=0;r<s.length;r++)f.push(s[r])}),els=t.querySelectorAll(l),a(els,function(n){a(f,function(t){n instanceof HTMLElement&&h.attach(n,t)})}),h},attach:function(n,t){var e=this;return sensor=e.getSensor(n),sensor.add(t),sensor.resetDimensions(),e},getSensor:function(n){var t,r,i,s,o,a=this,u=n.toString();return a.watchers||(a.watchers={}),r=a.watchers,r[u]||(r[u]={}),i=r[u],i.els||(i.els=[]),i.sensors||(i.sensors=[]),t=i.els,o=i.sensors,s=t.indexOf(n),-1===s&&(s=t.length,t.push(n)),o[s]||(o[s]=new e(n)),o[s]},applySensorValues:function(){var n,t,e,r=this,s=r.watchers;for(n in s)for(t=s[n].sensors,i=0;i<t.length;i++)e=t[i],e.update();return r},unitProcessor:function(n,t){var e=this;return l[n]=t,e},addProcessor:function(n,t){var e=this;return c[n]={fn:t,regex:v(n,y)},e},physicalDistance:function(t){return function(e){return e/n.devicePixelRatio/t}}},n.onload=function(){elementQuery.reinit(),elementQuery.applySensorValues()},n.ElementQuery=r,n.elementQuery=new n.ElementQuery,n.elementQuery.reinit(t.styleSheets)}(window,document);